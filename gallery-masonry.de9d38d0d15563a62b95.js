"use strict";(globalThis.webpackChunknew_bedford_framework=globalThis.webpackChunknew_bedford_framework||[]).push([[6197],{59067:(t,e,i)=>{i.r(e),i.d(e,{GalleryMasonry:()=>g,default:()=>m});var s=i(59440),o=i(82e3),r=i(22902),a=i(62603),n=i(52008),h=i(75396),l=i(68651),c=i(67373),u=i(63285);function d(t,e,i){var s;return(e="symbol"==typeof(s=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var s=i.call(t,e||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?s:s+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class g extends c.A{constructor(t){super(),d(this,"loadImage",t=>{const{imageSelector:e}=this.props,i=t.querySelector(e);i.onload=()=>{t.dataset.loaded=!0},i.onload()}),d(this,"onLightboxOpen",t=>{const{isHistoryEnabled:e}=this.state;e&&(t.preventDefault(),history.pushState({},"",t.currentTarget.href))}),d(this,"onResize",()=>{const t=this.getColumnData(this.state.numColumns,this.state.gutter),e="full-bleed"===this.node.dataset.width;this.packer.layout({...t,shouldApplyGutterToContainerEdge:e}),this.loadImages(this.ref.items)}),d(this,"onItemShow",t=>{let{node:e}=t;e.dataset.show||(e.dataset.show=!0)}),d(this,"removeLightboxElementFromDOM",()=>{if(this.state.lightboxEnabled){const t=document.querySelector(`[data-lightbox-section-id="${this.sectionId}"]`);t&&t.remove()}}),this.betaFeatureFlags=(0,s.T)(window,"Static.SQUARESPACE_CONTEXT.betaFeatureFlags",[]);const{listSelector:e,itemSelector:i,lightboxLinkSelector:r}=this.props,l=(0,s.T)(window,"Static.SQUARESPACE_CONTEXT.collection.fullUrl",null);let c={};t.dataset.props&&(c=JSON.parse(t.dataset.props)),this.history=(0,o.J)(),this.node=t,this.sectionId=this.node.dataset.sectionId,this.state={design:"masonry",collectionFullUrl:l,isHistoryEnabled:l&&this.history,numColumns:3,gutter:10,lightboxEnabled:!1,width:"full",...c},this.ref={list:this.node.querySelector(e),items:Array.from(this.node.querySelectorAll(i)),lightboxLinks:Array.from(this.node.querySelectorAll(r))},this.onResize=(0,h.A)(this.onResize,u.X0),this.stagger=new n.A({nodes:this.ref.items,onEnter:this.onItemShow}),this.packer=new a.A({container:this.ref.list,nodes:this.ref.items,imageWrapperSelector:".gallery-masonry-item-wrapper",isReadyClass:"gallery-masonry-list--ready",shouldApplyGutterToContainerEdge:"full-bleed"===this.node.dataset.width,...this.getColumnData(this.state.numColumns,this.state.gutter)}),this.node.dataset.lightbox=this.state.lightboxEnabled,this.bindListeners()}loadImages(t){t.forEach(this.loadImage)}bindListeners(){this.ref.lightboxLinks.forEach(t=>{t.addEventListener("click",this.onLightboxOpen)}),l.A.on(this.onResize),this.stagger.start(),this.onResize()}unbindListeners(){this.ref.lightboxLinks.forEach(t=>{t.removeEventListener("click",this.onLightboxOpen)}),l.A.off(this.onResize)}getColumnData(t,e){const i=(0,r._v)(t),s=(0,r.kr)(e);return{columns:i,horizontalGutter:s,verticalGutter:s}}destroy(){this.unbindListeners(),this.removeLightboxElementFromDOM(),this.stagger.destroy(),this.packer.destroy()}}d(g,"defaultProps",{listSelector:".gallery-masonry-wrapper",itemSelector:".gallery-masonry-item",lightboxLinkSelector:".gallery-masonry-lightbox-link",imageSelector:"img",loadedItemClass:"loaded"});const m=t=>new g(t)},62603:(t,e,i)=>{i.d(e,{A:()=>h});var s=i(67373),o=i(66367),r=i(22902);const a=t=>t.indexOf(Math.min(...t));class n{constructor(t){let{node:e,imgWrapper:i,img:s,autoFitImage:o}=t;this.node=e,this.imageWrapper=i,this.lightboxLink=null==i?void 0:i.querySelector("a"),this.image=s,this.node.style.position="absolute",this.autoFitImage=o,o&&this.image&&(this.imageAspectRatio=(0,r.P6)(this.image))}applyAspectRatio(t){let{aspectRatio:e,x:i,y:s,width:r,height:a}=t;if(e<=0)return(0,o.h)(this.image,{width:"100%",top:"0%",left:"0%",transform:"none"}),void(this.imageWrapper.style.height="auto");const n=Math.ceil(r*(1/e));if(a/n<1){const t=n/a,e=Math.round(r*t);(0,o.h)(this.image,{width:`${e}px`,height:`${n}px`})}this.imageWrapper.style.height=`${n}px`,this.imageWrapper.style.overflow="hidden",this.lightboxLink&&(this.lightboxLink.style.height="100%")}setPosition(t,e,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;if(s=this.imageAspectRatio?this.imageAspectRatio:s,(0,o.h)(this.node,{width:`${Math.round(i)}px`,transform:`translate3d(${Math.round(t)}px, ${Math.round(e)}px, 0)`}),!this.autoFitImage||!this.image)return this.node.clientHeight;const r=Math.round(1/this.imageAspectRatio*i);return this.image.style.width="100%",this.image.style.height=`${r}px`,this.imageWrapper&&this.applyAspectRatio({aspectRatio:s,x:t,y:e,width:i,height:r}),this.node.clientHeight}clearPosition(){this.node.style.width="",this.node.style.transform="",this.autoFitImage&&this.image&&this.imageWrapper&&(this.image.style.width="",this.image.style.height="",this.imageWrapper.style.top="",this.imageWrapper.style.left="",this.imageWrapper.style.transform="")}}class h extends s.A{constructor(t){super(t);const{container:e,nodes:i,gutter:s,columns:o,isReadyClass:r,aspectRatio:a,horizontalGutter:n,verticalGutter:h}=this.props;this.state={columns:o,aspectRatio:a,horizontalGutter:isNaN(n)?s:n,verticalGutter:isNaN(h)?s:h,shouldApplyGutterToContainerEdge:!1},this.nodes=this.getNodes(i),this.len=this.nodes.length,this.layout(),setTimeout(()=>{e.classList.add(r)},0)}getNodes(t){const{imageWrapperSelector:e,imageSelector:i,autoFitImage:s,aspectRatio:o}=this.props;return t.map(t=>{const r=t.querySelector(e),a=t.querySelectorAll(i)[0];return new n({node:t,imgWrapper:r,img:a,autoFitImage:s,aspectRatio:o})})}setStyles(){const{container:t}=this.props,{columns:e,horizontalGutter:i,verticalGutter:s,aspectRatio:o,shouldApplyGutterToContainerEdge:r}=this.state,n=(h=e,"function"==typeof(l=0)?new Array(h).fill("").map(l):new Array(h).fill(l));var h,l;const c=t.clientWidth,u=c/100,d=i/20*u,g=s/20*u;let m=0,p=(c+d)/e,y=p-d;r&&(m=d,p=(c-d)/e,y=p-d);for(let t=0;t<this.len;t+=1){const e=a(n),i=m+p*e,s=this.nodes[t].setPosition(i,n[e],y,o);n[e]+=s+g}var f;t.style.height=n[(f=n,f.indexOf(Math.max(...f)))]-g+"px"}clearStyles(){const{container:t}=this.props;t.style.height="";for(let t=0;t<this.len;t+=1)this.nodes[t].clearPosition()}layout(t){t&&this.setState({...t}),this.setStyles()}destroy(){this.clearStyles()}}var l,c,u,d;l=h,c="defaultProps",u={container:document.createElement("div"),nodes:[],autoFitImage:!0,imageWrapperSelector:null,imageSelector:"img",aspectRatio:-1,gutter:0,columns:2,isReadyClass:"masonry-ready",horizontalGutter:void 0,verticalGutter:void 0},(c="symbol"==typeof(d=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var s=i.call(t,e||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(c,"string"))?d:d+"")in l?Object.defineProperty(l,c,{value:u,enumerable:!0,configurable:!0,writable:!0}):l[c]=u},52008:(t,e,i)=>{i.d(e,{A:()=>h});var s=i(67279),o=i.n(s),r=i(67373),a=i(49099);function n(t,e,i){var s;return(e="symbol"==typeof(s=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var s=i.call(t,e||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?s:s+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class h extends r.A{constructor(t){super(t),n(this,"onNodeEnter",t=>{const{node:e}=t,{delay:i,stagger:s}=this.props;e.__staggerEntered||(e.__staggerEntered=!0,e.__staggerTimeout=setTimeout(()=>{this.props.onEnter(t)},i+this.count*s),this.instant||(this.count+=1,this.count=Math.min(this.props.maxCount,this.count),this.countTimeout()))}),this.state={isActive:!1},this.count=0,this.baseTimeout=null,this.instant=!1,this.viewportWatcher=new(o())}start(){this.state.isActive||(this.setState({isActive:!0}),this.viewportWatcher.addNodes({nodes:this.props.nodes,range:[100,0],callbacks:{onEnter:this.onNodeEnter}}))}countTimeout(){clearTimeout(this.baseTimeout),this.baseTimeout=setTimeout(()=>{this.count=0},10)}destroy(){this.viewportWatcher.destroy(),clearTimeout(this.baseTimeout),this.props.nodes.forEach(t=>{clearTimeout(t.__staggerTimeout)})}}n(h,"defaultProps",{delay:50,stagger:50,maxCount:20,nodes:[],onEnter:a.l})},66367:(t,e,i)=>{i.d(e,{h:()=>s,v:()=>o});const s=(t,e)=>(Object.keys(e).forEach(i=>{t.style[i]=e[i]}),t),o=t=>"object"==typeof t&&null!==t&&1===t.nodeType},82e3:(t,e,i)=>{i.d(e,{J:()=>n});const s=Array.prototype.slice,o=function(){const t=s.call(arguments);return function(){let e=s.call(arguments);for(let i=t.length-1;i>=0;i--)e=[t[i].apply(this,e)];return e[0]}},r=[],a={executeCallbacks(){r.forEach(t=>t())},trigger(){this.executeCallbacks()},registerCallback(t){t&&r.push(t)},removeCallback(t){if(t){const e=r.indexOf(t);e>-1&&r.splice(e,1)}},on(t){this.registerCallback(t)},off(t){this.removeCallback(t)}};window.history&&window.history.pushState&&(history.change=a,history.pushState=o(()=>history.change.trigger(),history.pushState),history.replaceState=o(()=>history.change.trigger(),history.replaceState),window.addEventListener("popstate",()=>{history.change.trigger()}));const n=()=>window.history&&window.history.pushState?history:null},22902:(t,e,i)=>{i.d(e,{P6:()=>o,TT:()=>h,_v:()=>a,kr:()=>r,pG:()=>n});i(68444);var s=i(63285);const o=t=>{if(!t)return 1;if(!t.dataset.imageDimensions){const e=t.getAttribute("width"),i=t.getAttribute("height");return e&&i?+e/+i:1}const e=t.dataset.imageDimensions.split("x");return e[0]&&e[1]?+e[0]/+e[1]:void 0},r=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;if(t<=e)return t;const i=window.innerWidth;return i<=s.fi.sm?Math.max(e,Math.round(.25*t)):i<=s.fi.md?Math.max(e,Math.round(.5*t)):i<=s.fi.lg?Math.max(e,Math.round(.75*t)):t},a=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;const e=window.innerWidth;let i=Math.max(1,t);return 1===i?i:e<=s.fi.sm?2:e<=s.fi.md?Math.max(Math.ceil(.5*i),2):e<=s.fi.lg?Math.ceil(.75*i):i},n=t=>{let e=0,i=0;const s={width:e,height:i};return t?(t.dataset.imageDimensions?[e,i]=t.dataset.imageDimensions.split("x"):(e=t.getAttribute("width"),i=t.getAttribute("height")),e&&i?{width:+e,height:+i}:s):s},h=t=>{const e={x:.5,y:.5};if(!t)return e;if(!t.dataset.imageFocalPoint)return e;const[i,s]=t.dataset.imageFocalPoint.split(",");return i&&s?{x:+i,y:+s}:e}}}]);
//# sourceMappingURL=https://sourcemaps.squarespace.net/new-bedford-framework/sourcemaps/ded035f0dbda5236298553dc3c344947/scripts/gallery-masonry.de9d38d0d15563a62b95.js.map